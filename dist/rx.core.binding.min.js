/* Copyright (c) Microsoft Open Technologies, Inc. All rights reserved. See License.txt in the project root for license information.*/
(function(a){function b(a){return a&&a.Object===Object?a:null}var c={function:!0,object:!0},d=c[typeof exports]&&exports&&!exports.nodeType?exports:null,e=c[typeof module]&&module&&!module.nodeType?module:null,f=b(d&&e&&"object"==typeof global&&global),g=b(c[typeof self]&&self),h=b(c[typeof window]&&window),i=(e&&e.exports===d?d:null,b(c[typeof this]&&this)),j=f||h!==(i&&i.window)&&h||g||i||Function("return this")();"function"==typeof define&&define.amd?define(["./rx.core"],function(b,c){return a(j,c,b)}):"object"==typeof module&&module&&module.exports===d?module.exports=a(j,module.exports,require("./rx.core")):j.Rx=a(j,{},j.Rx)}).call(this,function(a,b,c,d){function e(a){for(var b=a.length,c=new Array(b),d=0;d<b;d++)c[d]=a[d];return c}function f(a){return function(){try{return a.apply(this,arguments)}catch(a){return w.e=a,w}}}function g(a){throw a}function h(a){for(var b=[],c=[a],d=0;c.length;){var e=c.pop();if("boolean"==typeof e)d+=4;else if("string"==typeof e)d+=2*e.length;else if("number"==typeof e)d+=8;else if("object"==typeof e&&b.indexOf(e)===-1){b.push(e);for(var f in e)c.push(e[f])}}return d}var i=c.Observable,j=i.prototype,k=(c.AnonymousObservable,c.ObservableBase),l=c.Observer,m=c.internals.AbstractObserver,n=c.Disposable.create,o=c.Disposable.empty,p=(c.CompositeDisposable,c.BinaryDisposable),q=c.SerialDisposable,r=c.Scheduler.currentThread,s=c.helpers.isFunction,t=c.internals.inherits,u=c.internals.addProperties,v=c.Disposable.checkDisposed,w={e:{}},x=c.internals.tryCatch=function(a){if(!s(a))throw new TypeError("fn must be a function");return f(a)},y=function(a){function b(b,c,d){this.source=b,this._fn1=c,this._fn2=d,a.call(this)}return t(b,a),b.prototype.subscribeCore=function(a){var b=this.source.multicast(this._fn1());return new p(this._fn2(b).subscribe(a),b.connect())},b}(k);j.multicast=function(a,b){return s(a)?new y(this,a,b):new H(this,a)},j.publish=function(a){return a&&s(a)?this.multicast(function(){return new B},a):this.multicast(new B)},j.share=function(){return this.publish().refCount()},j.publishLast=function(a){return a&&s(a)?this.multicast(function(){return new D},a):this.multicast(new D)},j.publishValue=function(a,b){return 2===arguments.length?this.multicast(function(){return new E(b)},a):this.multicast(new E(a))},j.shareValue=function(a){return this.publishValue(a).refCount()},j.replay=function(a,b,c,d){return a&&s(a)?this.multicast(function(){return new F(b,c,d)},a):this.multicast(new F(b,c,d))},j.shareReplay=function(a,b,c){return this.replay(null,a,b,c).refCount()};var z=c.internals.ScheduledObserver=function(a){function b(b,c){a.call(this),this.scheduler=b,this.observer=c,this.isAcquired=!1,this.hasFaulted=!1,this.queue=[],this.disposable=new q}function c(a,b){return function(){a.onNext(b)}}function d(a,b){return function(){a.onError(b)}}function e(a){return function(){a.onCompleted()}}function f(a,b){var c;if(!(a.queue.length>0))return void(a.isAcquired=!1);c=a.queue.shift();var d=x(c)();return d===w?(a.queue=[],a.hasFaulted=!0,g(d.e)):void b(a)}return t(b,a),b.prototype.next=function(a){this.queue.push(c(this.observer,a))},b.prototype.error=function(a){this.queue.push(d(this.observer,a))},b.prototype.completed=function(){this.queue.push(e(this.observer))},b.prototype.ensureActive=function(){var a=!1;!this.hasFaulted&&this.queue.length>0&&(a=!this.isAcquired,this.isAcquired=!0),a&&this.disposable.setDisposable(this.scheduler.scheduleRecursive(this,f))},b.prototype.dispose=function(){a.prototype.dispose.call(this),this.disposable.dispose()},b}(m),A=function(a,b){this._s=a,this._o=b};A.prototype.dispose=function(){if(!this._s.isDisposed&&null!==this._o){var a=this._s.observers.indexOf(this._o);this._s.observers.splice(a,1),this._o=null}};var B=c.Subject=function(a){function b(){a.call(this),this.isDisposed=!1,this.isStopped=!1,this.observers=[],this.hasError=!1}return t(b,a),u(b.prototype,l.prototype,{_subscribe:function(a){return v(this),this.isStopped?this.hasError?(a.onError(this.error),o):(a.onCompleted(),o):(this.observers.push(a),new A(this,a))},hasObservers:function(){return v(this),this.observers.length>0},onCompleted:function(){if(v(this),!this.isStopped){this.isStopped=!0;for(var a=0,b=e(this.observers),c=b.length;a<c;a++)b[a].onCompleted();this.observers.length=0}},onError:function(a){if(v(this),!this.isStopped){this.isStopped=!0,this.error=a,this.hasError=!0;for(var b=0,c=e(this.observers),d=c.length;b<d;b++)c[b].onError(a);this.observers.length=0}},onNext:function(a){if(v(this),!this.isStopped)for(var b=0,c=e(this.observers),d=c.length;b<d;b++)c[b].onNext(a)},dispose:function(){this.isDisposed=!0,this.observers=null}}),b.create=function(a,b){return new C(a,b)},b}(i),C=c.AnonymousSubject=function(a){function b(b,c){this.observer=b,this.observable=c,a.call(this)}return t(b,a),u(b.prototype,l.prototype,{_subscribe:function(a){return this.observable.subscribe(a)},onCompleted:function(){this.observer.onCompleted()},onError:function(a){this.observer.onError(a)},onNext:function(a){this.observer.onNext(a)}}),b}(i),D=c.AsyncSubject=function(a){function b(){a.call(this),this.isDisposed=!1,this.isStopped=!1,this.hasValue=!1,this.observers=[],this.hasError=!1}return t(b,a),u(b.prototype,l.prototype,{_subscribe:function(a){return v(this),this.isStopped?(this.hasError?a.onError(this.error):this.hasValue?(a.onNext(this.value),a.onCompleted()):a.onCompleted(),o):(this.observers.push(a),new A(this,a))},hasObservers:function(){return v(this),this.observers.length>0},onCompleted:function(){var a,b;if(v(this),!this.isStopped){this.isStopped=!0;var c=e(this.observers),b=c.length;if(this.hasValue)for(a=0;a<b;a++){var d=c[a];d.onNext(this.value),d.onCompleted()}else for(a=0;a<b;a++)c[a].onCompleted();this.observers.length=0}},onError:function(a){if(v(this),!this.isStopped){this.isStopped=!0,this.hasError=!0,this.error=a;for(var b=0,c=e(this.observers),d=c.length;b<d;b++)c[b].onError(a);this.observers.length=0}},onNext:function(a){v(this),this.isStopped||(this.value=a,this.hasValue=!0)},dispose:function(){this.isDisposed=!0,this.observers=null,this.error=null,this.value=null}}),b}(i),E=c.BehaviorSubject=function(a){function b(b){a.call(this),this.value=b,console.log(h(this.value)),this.observers=[],this.isDisposed=!1,this.isStopped=!1,this.hasError=!1}return t(b,a),u(b.prototype,l.prototype,{_subscribe:function(a){return v(this),this.isStopped?(this.hasError?a.onError(this.error):a.onCompleted(),o):(this.observers.push(a),a.onNext(this.value),new A(this,a))},getValue:function(){return v(this),this.hasError&&g(this.error),this.value},hasObservers:function(){return v(this),this.observers.length>0},onCompleted:function(){if(v(this),!this.isStopped){this.isStopped=!0;for(var a=0,b=e(this.observers),c=b.length;a<c;a++)b[a].onCompleted();this.observers.length=0}},onError:function(a){if(v(this),!this.isStopped){this.isStopped=!0,this.hasError=!0,this.error=a;for(var b=0,c=e(this.observers),d=c.length;b<d;b++)c[b].onError(a);this.observers.length=0}},onNext:function(a){if(v(this),!this.isStopped){this.value=a,console.log(h(this.value));for(var b=0,c=e(this.observers),d=c.length;b<d;b++)c[b].onNext(a)}},dispose:function(){this.isDisposed=!0,this.observers=null,this.value=null,this.error=null}}),b}(i),F=c.ReplaySubject=function(a){function b(a){for(var b=[],c=[a],d=0;c.length;){var e=c.pop();if("boolean"==typeof e)d+=4;else if("string"==typeof e)d+=2*e.length;else if("number"==typeof e)d+=8;else if("object"==typeof e&&b.indexOf(e)===-1){b.push(e);for(var f in e)c.push(e[f])}}return d}function c(a,b){return n(function(){b.dispose(),!a.isDisposed&&a.observers.splice(a.observers.indexOf(b),1)})}function d(b,c,d){this.bufferSize=null==b?f:b,this.windowSize=null==c?f:c,this.scheduler=d||r,this.q=[],this.observers=[],this.isStopped=!1,this.isDisposed=!1,this.hasError=!1,this.error=null,a.call(this)}var f=Math.pow(2,53)-1;return t(d,a),u(d.prototype,l.prototype,{_subscribe:function(a){v(this);var b=new z(this.scheduler,a),d=c(this,b);this._trim(this.scheduler.now()),this.observers.push(b);for(var e=0,f=this.q.length;e<f;e++)b.onNext(this.q[e].value);return this.hasError?b.onError(this.error):this.isStopped&&b.onCompleted(),b.ensureActive(),d},hasObservers:function(){return v(this),this.observers.length>0},_trim:function(a){for(;this.q.length>this.bufferSize;)this.q.shift();for(;this.q.length>0&&a-this.q[0].interval>this.windowSize;)this.q.shift()},onNext:function(a){if(v(this),!this.isStopped){var c=this.scheduler.now();this.q.push({interval:c,value:a}),console.log(b(this.q)),this._trim(c);for(var d=0,f=e(this.observers),g=f.length;d<g;d++){var h=f[d];h.onNext(a),h.ensureActive()}}},onError:function(a){if(v(this),!this.isStopped){this.isStopped=!0,this.error=a,this.hasError=!0;var b=this.scheduler.now();this._trim(b);for(var c=0,d=e(this.observers),f=d.length;c<f;c++){var g=d[c];g.onError(a),g.ensureActive()}this.observers.length=0}},onCompleted:function(){if(v(this),!this.isStopped){this.isStopped=!0;var a=this.scheduler.now();this._trim(a);for(var b=0,c=e(this.observers),d=c.length;b<d;b++){var f=c[b];f.onCompleted(),f.ensureActive()}this.observers.length=0}},dispose:function(){this.isDisposed=!0,this.observers=null}}),d}(i),G=function(a){function b(b){this.source=b,this._count=0,this._connectableSubscription=null,a.call(this)}function c(a,b){this._p=a,this._s=b,this.isDisposed=!1}return t(b,a),b.prototype.subscribeCore=function(a){var b=this.source.subscribe(a);return 1===++this._count&&(this._connectableSubscription=this.source.connect()),new c(this,b)},c.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._s.dispose(),0===--this._p._count&&this._p._connectableSubscription.dispose())},b}(k),H=c.ConnectableObservable=function(a){function b(b,c){this.source=b,this._connection=null,this._source=b.asObservable(),this._subject=c,a.call(this)}function c(a,b){this._p=a,this._s=b}return t(b,a),c.prototype.dispose=function(){this._s&&(this._s.dispose(),this._s=null,this._p._connection=null)},b.prototype.connect=function(){if(!this._connection){if(this._subject.isStopped)return o;var a=this._source.subscribe(this._subject);this._connection=new c(this,a)}return this._connection},b.prototype._subscribe=function(a){return this._subject.subscribe(a)},b.prototype.refCount=function(){return new G(this)},b}(i);return c});
//# sourceMappingURL=rx.core.binding.map